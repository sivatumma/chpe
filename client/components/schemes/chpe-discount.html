
<dom-module id="chpe-discount">
<style type="text/css">
    :host{
        display: block;
    }
    .discountBox{
        width: 320px;
        display: inline-block;
    }
   .discountButton{
        min-width:30px;
        background: #f4f4f4;
        border:1px solid #ccc;
    }
    .active{
        color:#000 !important;
        background: lightgreen !important;
        box-shadow: none;
    }
    .noRightBorder{
        border-right: none !important;
    }
    label{
        float: left;
        line-height:40px;
        margin-right: 10px;
    }
    .btn-group {
      display: inline-block;
      vertical-align: middle;
      float: left;
      margin:0px 20px 0px 0px;
    }
    .btn-group > paper-button {
      float: left;
      margin: 0px;
     border-radius: 0px !important;

    }
    .discountInput{
        width:35%;
        display: inline-block;
        margin: 0;
    }
</style>
    <template>
        <div class="discountBox"  id="discountToggle" layout horizontal>
            <div class="btn-group">
                <label>Discount Type</label>
                <paper-button type="button" class="discountButton noRightBorder active" 
                on-click="toogleDiscount" id="{{percentageId}}" discount="%">%</paper-button>

                <paper-button type="button" class="discountButton"
                on-click="toogleDiscount" id="{{flatId}}" discount="FLAT">Flat</paper-button>
            </div>
            <div class="discountInput">
                <paper-input name="discount" no-label-float label="Discount" type="number"  id="{{discountId}}" 
                max="{{discountLength}}" min="0"  required auto-validate pattern="{{discountPattern}}" 
                 error-message="Max 999 if Flat ; 10 if %" value="{{discount}}"></paper-input>
            </div>
        </div>
      		
    </template>
    <script>
        Polymer({
            is: 'chpe-discount',
            properties: {
                discountId:Boolean,
                percentageId:String,
                flatId:String,
                discount:String

            },
            ready:function(){
                this.discountLength  = 10;
                this.discountPattern = "^([0-10])$";
            },
            listeners:{
              'discountToggle.onClick':'toogleDiscount'
            },
            toogleDiscount:function(e){
                var discountType = e.target.innerText;

                //first removing all classes and setting clicked element to active
                chUtils.removeClass(document.querySelector("#"+this.percentageId),"active");
                chUtils.removeClass(document.querySelector("#"+this.flatId),"active");

                if (discountType == "%") {
                    this.discountLength = 10;
                    this.discountPattern = "^([0-10])$";
                    chUtils.addClass(document.querySelector("#"+this.percentageId),"active");
                    console.log(document.querySelector("#"+this.percentageId));
                } else {
                    chUtils.addClass(document.querySelector("#"+this.flatId),"active");
                    this.discountLength = 999;
                    this.discountPattern = "^([0-999])$";
                    console.log(document.querySelector("#"+this.flatId));
                }
            }
          
        });
       
        
    </script>
</dom-module>